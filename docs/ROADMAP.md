# 待办与里程碑（最新）

> 工作流：每轮从本页挑选 1-3 个条目→实现与测试→更新本页与 ARCHITECTURE/TESTING→中文提交信息推送。

- 已完成（阶段性）
  - [x] 单据流转列表/详情（入/出库 DRAFT→APPROVED→PUTAWAY/PICKED + 取消）
  - [x] 迁移切换（关闭 synchronize，使用 migrations）
  - [x] 一键启动脚本与测试文档
  - [x] UI 与主题美化（玻璃风、浅色修复、动态标题、渐入动画）
  - [x] 仪表盘简化（去除图表与装饰性 SVG，保留核心指标与列表，浅色模式细节微调）
  - [x] 未使用组件清理（移除 DashboardCharts 及相关引用）
  - [x] 鉴权（API Key + JWT，可 REQUIRE_JWT 强制 JWT）
  - [x] RBAC（ADMIN/OP/VIEWER）与路由保护
  - [x] 自动种子（首次无用户时创建 admin/op/viewer），封面登录流
  - [x] 新建入/出库专用页面与仪表盘/列表入口统一
  - [x] A：列表筛选/搜索与导出（入/出库支持状态/日期/单号筛选，库存/入库/出库 CSV 导出）
  - [x] B：供应商主数据与前端联动（新增 Supplier 实体/迁移/CRUD/种子，入库页供应商下拉联动）
  - [x] C：通知中心（实体/迁移/接口；入库上架、出库过账等事件生成通知；前端展示与“全部已读”）
  - [x] Dashboard 指标与预警面板（物料/库存/临期/今日单据/未读预警数；预警列表支持全部已读）
  - [x] 新增“分析/报表”页面：支持日/周趋势切换、低库存 TopN 卡片
  - [x] 分析页筛选：日期范围、物料编码（精确）、仓库与关键字（低库存）
  - [x] 报表导出：趋势（daily/weekly）与低库存 CSV 按筛选导出
  - [x] E：新建入/出库表单增强（行内校验、草稿保存/继续、批次建议与 FEFO 提示）
  - [x] F：阈值与预警（全局最低库存、临期天数、滞销天数 slowDays；手动重算；通知联动）
  - [x] G：导入导出增强（按筛选导出、订单级/明细级 CSV、物料导入模板与反馈）

- 短期可选项（下一阶段候选，Pick 1-3）
  - [x] D：全局搜索（物料/单号/批次）与跳转联动（已接入 `/api/search` 与前端 `SearchResults`）
  - [ ] G2：导入导出增强（Excel 模板/导出、字段勾选、自定义表头）
  - [ ] 代码体积优化：路由级代码分割（已启用）+ 手动 vendor 拆包（React/AntD/Dayjs 等）
  - [ ] 图标按需与进一步摇树（仅引入用到的 @ant-design/icons 图标）
  - [ ] PWA 基础缓存（静态资源预缓存与离线提示）
  - [ ] H：Dashboard 接入真实指标（已有卡片数据，按 docs 细化字段与口径；图表迁移到“分析/报表”页）
  - [ ] I：仓库与库位选择器联动（级联、缓存、离线）
  - [ ] 预警体验：预警项可点击跳转物料/单据详情，预警筛选与导出

## 本轮实施（进行中）
- 已选任务（本轮）
  - [x] 分析/报表：快捷导出入/出库单与明细（按日期/状态/单号）
  - [x] 通知中心：顶部通知弹层支持“仅未读/全部”切换与 CSV 导出
  - [x] 文档与脚本：补充 ARCHITECTURE/TESTING，新增指标冒烟脚本

- 验收要点
  - 前端构建通过；导出文件按筛选参数生成
  - 通知弹层切换“仅未读”能收敛列表，导出 CSV 可下载
  - 测试文档包含操作步骤；smoke:metrics 可运行（需 API 可达）

## 下一轮候选（拟定）
- 指标口径严格对齐与最小单测（slow/low/临期与趋势）
- 分析页趋势对比（按仓库/物料）与更多导出（按筛选导出入/出库明细扩展）

- 接下来根据 docs 继续开发（指引）
  - [ ] 按 docs/ 里的数据口径说明统一指标与列表字段（已在 ARCHITECTURE.md 补充口径，需代码层严格对齐与补测试）
  - [ ] 新建“分析/报表”页（迁移原图表到此页面，按需接入后端聚合接口）
  - [ ] 校对接口文档（server/routes 与前端 api 调用一一对齐）
  - [ ] 增补 README 的运行/构建/部署章节与常见问题

- 中期
  - [ ] 校验与错误码规范（字段校验、业务冲突、异常码表）
  - [ ] 并发控制（乐观锁/去重幂等、订单幂等键）
  - [ ] E2E/UI 自动化（Playwright）+ 单元测试（Jest）
  - [ ] 审批流/撤销、作废原因/操作审计
  - [ ] 多仓位库位策略（上架/拣货策略 FEFO 可配置）

- 长期
  - [ ] 数据全链路审计与报表（操作日志、库存变化、按单/按物料统计）